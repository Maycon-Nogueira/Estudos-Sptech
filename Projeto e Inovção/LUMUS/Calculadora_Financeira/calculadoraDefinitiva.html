<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h2>Calcule o quanto você economizará na conta de luz utilizando o monitoramento do nosso sensor</h2>

    <div class="principal">
        Quantidade de lâmpadas:
        <input type="text" id="qtd_lampada" placeholder="Ex: 50" min="1"><br>

        Potência da lâmpada:
        <input type="text" id="watts_consumido" placeholder="Ex: 25">
        <div style="display: flex; align-items: center;">
            <input style="margin: 7px; width: 20px;" type="radio" value="true" id="verWatt"> <span style="font-size: 20px;">Não sei</span>
        </div>
        <br>

        <h5>Horário de funcionamento do seu escritório</h5>
        Abertura:
        <input type="number" min="0" max="23" id="hrAbertura_input" placeholder="00/23">
        Fechamento:
        <input type="number" min="0" max="23" id="hrFechamento_input" placeholder="00/23">
        <br>
        
        <button onclick="calcularConsumo()">Calcular</button>
    </div>

    <div id="resultado" style="text-align: center; font-size: 20px; margin-top: 20px;"></div>
    <div id="res2" style="text-align: center; font-size: 20px; margin-top: 20px;"></div>

    <script>

        function calcularConsumo(){
            
            // Definindo as váriaveis que o usuário/cliente inseriu
            var qntLampadas = Number(qtd_lampada.value);
            var hrAbertura = Number(hrAbertura_input.value);
            var hrFechamento = Number(hrFechamento_input.value); 
            var watts = Number(watts_consumido.value);

            // Horário total de funcionamento da empresa
            var hrTotal = Number(hrFechamento - hrAbertura);  

            // Será o horário que a empresa fica aberta durante o dia e noite
            var HrDuranteDia = Number(0);  
            var HrDuranteNoite = Number(0); 
            

            var hrInicioDia = 7; // Horário que inicia o dia/sol
            var hrTerminoDia = 17; // Horário que termina o dia/sol

            // Condições para definir o total de horas que a empresa funciona das 7-17 (durante o dia)
            if(qntLampadas > 0){
                if(hrFechamento > hrAbertura){

                    if(hrAbertura <= hrInicioDia){
                        if(hrFechamento >= hrTerminoDia){
                            HrDuranteDia = hrTerminoDia - hrInicioDia;  // se expediente começar antes das 8 e terminar dps das 16 = HrDuranteDia = 17-7
                        }
                    }

                    if(hrAbertura >= hrInicioDia){
                        if(hrFechamento <= hrTerminoDia){
                            HrDuranteDia = hrFechamento - hrAbertura; // se expediente começar depois das 7 e terminar antes das 17 
                        }
                    }

                    if(hrAbertura <= hrInicioDia){
                        if(hrFechamento <= hrTerminoDia){
                            HrDuranteDia = hrFechamento - hrInicioDia; // se expediente começar antes das 7 e terminar antes das 17 = HrDuranteDia = fim do expediente - 7
                        }
                    }

                    if(hrAbertura >= hrInicioDia){
                        if(hrFechamento >= hrTerminoDia){
                            HrDuranteDia = hrTerminoDia - hrAbertura; // se expediente começar depois das 7 e terminar dps das 17 = HrDuranteDia = 17 - inicio expediente
                        }
                    }

                }else{
                    alert(`Horário de funcionamento inválido`);
                    var funInv = true;
                }
            }else{
                alert(`Quantidade de lâmpadas iválido`);
                var funInv = true;
            }

            // Calcular horário total que a empresa fica aberta durante a noite
            HrDuranteNoite = hrTotal - HrDuranteDia;             

            // Caso o usuário selecione a opção "não sei"
            var verificarWatts = document.getElementById("verWatt"); 
            if(verificarWatts.checked){
                watts = 30;
            }

            // kWh diário consumido pela empresa
            var kWhDiarioAoDia = (watts * qntLampadas * HrDuranteDia) / 1000; 
            var kWhDiarioAoNoite = (watts * qntLampadas * HrDuranteNoite) / 1000; 


            // Gasto mensal durante o dia e noite da empresa
            gastoMensalAoDia = (kWhDiarioAoDia * 27) * 0.85;  // 27 = dias do mes. 0.85 = valor por kWh consumidos
            gastoMensalAoNoite = (kWhDiarioAoNoite * 27) * 0.85; // 27 = dias do mes. 0.85 = valor por kWh consumidos

            // Definimos a economia mensal, supondo que a empresa irá economizar 50% durante o dia e 10% durante a noite
            economiaMensal = (gastoMensalAoDia * 0.50) + (gastoMensalAoNoite * 0.1);

            economiaAnual = economiaMensal * 12;

            // Condição para verificar se os valores inseridos são válidos
            if(funInv == true){
                resultado.innerHTML = `Recarregue a página e tente novamente com valores válidos`;
            }else{ // Exibição após o usuário/cliente clicar no botão
                resultado.innerHTML =   `Tempo de funcionamento: ${hrTotal}h <br>
                                    Com a nossa ferramenta você pode economizar até 50% dos gastos durante o dia e 10% durante a noite, 
                                    o que equivale a R$${economiaMensal.toFixed(2)} por mês!<br>
                                    Gerando assim uma economia média de: <b style="color:green">R$${economiaAnual.toFixed(2)}</b> ANUAL.<br><br>
                                    Valores baseados em ${watts}watts por lâmpada.<br><br>
                                    Não possui lâmpadas inteligentes? Clique <a href="#" onclick="calcLampadasInte()">aqui</a>`;
            }
            
        }   
            // Função para calcular lampadas inteligentes
            function calcLampadasInte(){
                var qntLampadas = Number(qtd_lampada.value);
                if(qntLampadas>=200){
                    res2.innerHTML = `Você gastará em média R$${qntLampadas*25} para trocar todas as lâmpadas da sua empresa. Ou seja, em <span style="color: green;">${parseInt((qntLampadas*25)/(economiaMensal))}</span> meses você começará a ter lucro.`;
                }
                if(qntLampadas>=50){
                    res2.innerHTML = `Você gastará em média R$${qntLampadas*30} para trocar todas as lâmpadas da sua empresa. Ou seja, em <span style="color: green;">${parseInt((qntLampadas*30)/(economiaMensal))}</span> meses você começará a ter lucro.`;
                }else{
                    res2.innerHTML = `Você gastará em média R$${qntLampadas*35} para trocar todas as lâmpadas da sua empresa. Ou seja, em <span style="color: green;">${parseInt((qntLampadas*35)/(economiaMensal))}</span> meses você começará a ter lucro.`;
                }

            }
    </script>

</body>
</html>